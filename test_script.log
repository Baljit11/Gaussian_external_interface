 Entering Gaussian System, Link 0=g16
 Input=test_script.com
 Output=test_script.log
 Initial command:
 /curc/sw/install/gaussian/g16_c.02/g16/l1.exe "/scratch/local/7972752/Gau-1467023.inp" -scrdir="/scratch/local/7972752/"
 Entering Link 1 = /curc/sw/install/gaussian/g16_c.02/g16/l1.exe PID=   1467024.
  
 Copyright (c) 1988-2021, Gaussian, Inc.  All Rights Reserved.
  
 This is part of the Gaussian(R) 16 program.  It is based on
 the Gaussian(R) 09 system (copyright 2009, Gaussian, Inc.),
 the Gaussian(R) 03 system (copyright 2003, Gaussian, Inc.),
 the Gaussian(R) 98 system (copyright 1998, Gaussian, Inc.),
 the Gaussian(R) 94 system (copyright 1995, Gaussian, Inc.),
 the Gaussian 92(TM) system (copyright 1992, Gaussian, Inc.),
 the Gaussian 90(TM) system (copyright 1990, Gaussian, Inc.),
 the Gaussian 88(TM) system (copyright 1988, Gaussian, Inc.),
 the Gaussian 86(TM) system (copyright 1986, Carnegie Mellon
 University), and the Gaussian 82(TM) system (copyright 1983,
 Carnegie Mellon University). Gaussian is a federally registered
 trademark of Gaussian, Inc.
  
 This software contains proprietary and confidential information,
 including trade secrets, belonging to Gaussian, Inc.
  
 This software is provided under written license and may be
 used, copied, transmitted, or stored only in accord with that
 written license.
  
 The following legend is applicable only to US Government
 contracts under FAR:
  
                    RESTRICTED RIGHTS LEGEND
  
 Use, reproduction and disclosure by the US Government is
 subject to restrictions as set forth in subparagraphs (a)
 and (c) of the Commercial Computer Software - Restricted
 Rights clause in FAR 52.227-19.
  
 Gaussian, Inc.
 340 Quinnipiac St., Bldg. 40, Wallingford CT 06492
  
  
 ---------------------------------------------------------------
 Warning -- This program may not be used in any manner that
 competes with the business of Gaussian, Inc. or will provide
 assistance to any competitor of Gaussian, Inc.  The licensee
 of this program is prohibited from giving any competitor of
 Gaussian, Inc. access to this program.  By using this program,
 the user acknowledges that Gaussian, Inc. is engaged in the
 business of creating and licensing software in the field of
 computational chemistry and represents and warrants to the
 licensee that it is not a competitor of Gaussian, Inc. and that
 it will not use this program in any manner prohibited above.
 ---------------------------------------------------------------
  

 Cite this work as:
 Gaussian 16, Revision C.02,
 M. J. Frisch, G. W. Trucks, H. B. Schlegel, G. E. Scuseria, 
 M. A. Robb, J. R. Cheeseman, G. Scalmani, V. Barone, 
 G. A. Petersson, H. Nakatsuji, X. Li, M. Caricato, A. V. Marenich, 
 J. Bloino, B. G. Janesko, R. Gomperts, B. Mennucci, H. P. Hratchian, 
 J. V. Ortiz, A. F. Izmaylov, J. L. Sonnenberg, D. Williams-Young, 
 F. Ding, F. Lipparini, F. Egidi, J. Goings, B. Peng, A. Petrone, 
 T. Henderson, D. Ranasinghe, V. G. Zakrzewski, J. Gao, N. Rega, 
 G. Zheng, W. Liang, M. Hada, M. Ehara, K. Toyota, R. Fukuda, 
 J. Hasegawa, M. Ishida, T. Nakajima, Y. Honda, O. Kitao, H. Nakai, 
 T. Vreven, K. Throssell, J. A. Montgomery, Jr., J. E. Peralta, 
 F. Ogliaro, M. J. Bearpark, J. J. Heyd, E. N. Brothers, K. N. Kudin, 
 V. N. Staroverov, T. A. Keith, R. Kobayashi, J. Normand, 
 K. Raghavachari, A. P. Rendell, J. C. Burant, S. S. Iyengar, 
 J. Tomasi, M. Cossi, J. M. Millam, M. Klene, C. Adamo, R. Cammi, 
 J. W. Ochterski, R. L. Martin, K. Morokuma, O. Farkas, 
 J. B. Foresman, and D. J. Fox, Gaussian, Inc., Wallingford CT, 2019.
 
 ******************************************
 Gaussian 16:  ES64L-G16RevC.02  7-Dec-2021
                10-Sep-2024 
 ******************************************
 %mem=20GB
 ---------------------------------
 # opt external=" python utils.py"
 ---------------------------------
 1/6=10,10=10,18=4000020,19=15,26=1,38=1/1,3;
 2/9=110,12=2,17=6,18=5,40=1/2;
 3/11=9,25=1,30=1,41=9900000,43=2,71=1/1;
 4/20=17,22=1001,24=3,113=1,114=1/2;
 6/7=2,8=2,9=2,10=2/1;
 7/44=-1/16;
 1/6=10,10=10,18=4000020,19=15,26=1/3(2);
 2/9=110/2;
 99//99;
 2/9=110/2;
 3/11=9,25=1,30=1,41=9900000,43=2,71=1/1;
 4/16=2,20=17,22=1001,24=3,113=1,114=1/2;
 7/44=-1/16;
 1/6=10,10=10,18=4000020,19=15,26=1/3(-4);
 2/9=110/2;
 6/7=2,8=2,9=2,10=2/1;
 99/9=10/99;
 -------------
 test external
 -------------
 Symbolic Z-matrix:
 Charge =  0 Multiplicity = 1
 C                    -0.80882   0.29412   0. 
 H                    -0.45217  -0.71469   0. 
 H                    -0.45215   0.79852   0.87365 
 H                    -0.45215   0.79852  -0.87365 
 H                    -1.87882   0.29413   0. 
 

 GradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGrad
 Berny optimization.
 Initialization pass.
 No Z-matrix variables, so optimization will use Cartesian coordinates.
 Trust Radius=1.00D-01 FncErr=1.00D-07 GrdErr=1.00D-07 EigMax=2.50D+02 EigMin=1.00D-04
 Number of steps in this run=      2 maximum allowed number of steps=      2.
 GradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGrad

                          Input orientation:                          
 ---------------------------------------------------------------------
 Center     Atomic      Atomic             Coordinates (Angstroms)
 Number     Number       Type             X           Y           Z
 ---------------------------------------------------------------------
      1          6           0       -0.808824    0.294118    0.000000
      2          1           0       -0.452169   -0.714692    0.000000
      3          1           0       -0.452151    0.798516    0.873652
      4          1           0       -0.452151    0.798516   -0.873652
      5          1           0       -1.878824    0.294131    0.000000
 ---------------------------------------------------------------------
                    Distance matrix (angstroms):
                    1          2          3          4          5
     1  C    0.000000
     2  H    1.070000   0.000000
     3  H    1.070000   1.747302   0.000000
     4  H    1.070000   1.747302   1.747303   0.000000
     5  H    1.070000   1.747303   1.747303   1.747303   0.000000
 Stoichiometry    CH4
 Framework group  T[O(C),4C3(H)]
 Deg. of freedom     1
 Full point group                 T       NOp  12
 Largest Abelian subgroup         D2      NOp   4
 Largest concise Abelian subgroup D2      NOp   4
                         Standard orientation:                         
 ---------------------------------------------------------------------
 Center     Atomic      Atomic             Coordinates (Angstroms)
 Number     Number       Type             X           Y           Z
 ---------------------------------------------------------------------
      1          6           0        0.000000   -0.000000   -0.000000
      2          1           0        0.617765    0.617765    0.617765
      3          1           0       -0.617765   -0.617765    0.617765
      4          1           0       -0.617765    0.617765   -0.617765
      5          1           0        0.617765   -0.617765   -0.617765
 ---------------------------------------------------------------------
 Rotational constants (GHZ):         164.2463796         164.2463796         164.2463796
 Standard basis: STO-3G (5D, 7F)
 There are     3 symmetry adapted cartesian basis functions of A   symmetry.
 There are     2 symmetry adapted cartesian basis functions of B1  symmetry.
 There are     2 symmetry adapted cartesian basis functions of B2  symmetry.
 There are     2 symmetry adapted cartesian basis functions of B3  symmetry.
 There are     3 symmetry adapted basis functions of A   symmetry.
 There are     2 symmetry adapted basis functions of B1  symmetry.
 There are     2 symmetry adapted basis functions of B2  symmetry.
 There are     2 symmetry adapted basis functions of B3  symmetry.
     9 basis functions,    27 primitive gaussians,     9 cartesian basis functions
     5 alpha electrons        5 beta electrons
       nuclear repulsion energy        13.6865185999 Hartrees.
 NAtoms=    5 NActive=    5 NUniq=    2 SFac= 4.00D+00 NAtFMM=   60 NAOKFM=F Big=F
 Integral buffers will be    131072 words long.
 Raffenetti 1 integral format.
 Two-electron integral symmetry is turned on.
 External calculation of energy and first derivatives.
 Running external command " python utils.py R"
         input file       "/scratch/local/7972752/Gau-1467024.EIn"
         output file      "/scratch/local/7972752/Gau-1467024.EOu"
         message file     "/scratch/local/7972752/Gau-1467024.EMs"
         fchk file        "/scratch/local/7972752/Gau-1467024.EFC"
         mat. el file     "/scratch/local/7972752/Gau-1467024.EUF"
#INFO: **** input file is /projects/basi7344/software/alpine/research/external_gau/final_script/utils.py ****
from pyscf import gto, scf
import sys
import os
import numpy as np
import fortranformat as ff

basis = 'ccpvdz'
ifile = sys.argv[2]
ofile = sys.argv[3]

def read_gauss_input(ifile):
    with open(ifile, "r") as ifile:
        gau_input = ifile.readlines()

    tokens = gau_input[0].split()

    natoms = int(tokens[0])
    chrg = int(tokens[2])
    spin = int(tokens[3]) -1 
    coords = np.empty((natoms, 4))
    atomtypes=[]
    for i, line in enumerate(gau_input[1 : 1 + natoms]):
        line = line.split()
        line_re = line[:-1]
        coords[i] = line_re
    return natoms, chrg, spin, coords

def convert_to_xyz(data):
    coord_empty = ''
    coord_final =''
    for i, value in enumerate(data):
        coord_empty = ' '.join(f'{x:.8f}' if not float(x).is_integer() else f'{int(x)}' for x in value) 
        coord_final += coord_empty
        if i < len(data)-1:
            coord_final += ';'
    return coord_final

def pyscf_inp():
    mol=gto.Mole()
    mol.spin = s
    mol.charge = c
    mol.basis = basis
    mol.atom = cr
    mol.unit = 'bohr'
    mol.verbose = 4
    mol.build()
    mf = scf.RHF(mol)
    scf_ener = mf.scf()
    nuc_ener = mf.energy_nuc()
    g = mf.nuc_grad_method()
    grad = g.kernel()
    return grad, scf_ener, nuc_ener


def read_gauss_out(ofile, energy, natoms, gradient):

    headformat = ff.FortranRecordWriter("4D20.12")
    bodyformat = ff.FortranRecordWriter("3D20.12")

    f = open(ofile, "w")
    head = [energy, 0 , 0, 0]
    headstring = headformat.write(head)
    f.write(headstring + "\n")

    for i in range(natoms):
        output = bodyformat.write(gradient[i])
        f.write(output + "\n")

    # polarizability and dipole derivatives are set to zero
    polarizability = np.zeros((2, 3))
    dipole_derivative = np.zeros((3 * natoms, 3))

    for i in range(2):
        output = bodyformat.write(polarizability[i])
        f.write(output + "\n")

    for i in range(3 * natoms):
        output = bodyformat.write(dipole_derivative[i])
        f.write(output + "\n")

    f.close()


if __name__=="__main__":
    n , c, s, coord = read_gauss_input(ifile)
    cr = convert_to_xyz(coord)
    gradient, energy_scf, energy_nuc = pyscf_inp()
    read_gauss_out(ofile, energy_scf, n, gradient)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='c3cpu-a2-u32-1.rc.int.colorado.edu', release='4.18.0-305.34.2.el8_4.x86_64', version='#1 SMP Mon Jan 17 09:42:23 EST 2022', machine='x86_64')  Threads 1
Python 3.9.13 (main, Aug 25 2022, 23:26:10) 
[GCC 11.2.0]
numpy 1.21.5  scipy 1.9.1
Date: Tue Sep 10 13:07:59 2024
PySCF version 2.5.0
PySCF path  /projects/basi7344/software/alpine/pyscf
GIT HEAD (branch master) 6d3b24bb64e2a5edb7990b6e3304068981a33f54

[ENV] PYSCF_TMPDIR /scratch/alpine/basi7344/TEMP
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 5
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.617764762218   0.617764762218   0.617764762218 AA    1.167406210000   1.167406210000   1.167406210000 Bohr   0.0
[INPUT]  3 H     -0.617764762218  -0.617764762218   0.617764762218 AA   -1.167406210000  -1.167406210000   1.167406210000 Bohr   0.0
[INPUT]  4 H     -0.617764762218   0.617764762218  -0.617764762218 AA   -1.167406210000   1.167406210000  -1.167406210000 Bohr   0.0
[INPUT]  5 H      0.617764762218  -0.617764762218  -0.617764762218 AA    1.167406210000  -1.167406210000  -1.167406210000 Bohr   0.0

nuclear repulsion = 13.6865185975931
number of shells = 17
number of NR pGTOs = 54
number of NR cGTOs = 34
basis = ccpvdz
ecp = {}
CPU time:         0.50


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/alpine/basi7344/TEMP/tmp50vimtqt
max_memory 4000 MB (current use 120 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -40.0906472907227
  HOMO = -0.482579878410577  LUMO = 0.135712962424971
cycle= 1 E= -40.1899150741844  delta_E= -0.0993  |g|= 0.149  |ddm|= 1.59
  HOMO = -0.550631458930077  LUMO = 0.191158909554956
cycle= 2 E= -40.1969947134961  delta_E= -0.00708  |g|= 0.0345  |ddm|= 0.114
  HOMO = -0.547031503788908  LUMO = 0.19545576802723
cycle= 3 E= -40.1974826146015  delta_E= -0.000488  |g|= 0.00308  |ddm|= 0.0337
  HOMO = -0.547739745640908  LUMO = 0.195404252548962
cycle= 4 E= -40.1974876833312  delta_E= -5.07e-06  |g|= 0.000418  |ddm|= 0.00555
  HOMO = -0.547576367490585  LUMO = 0.195442336417583
cycle= 5 E= -40.1974877636348  delta_E= -8.03e-08  |g|= 0.000153  |ddm|= 0.000849
  HOMO = -0.547630911997348  LUMO = 0.19542045959236
cycle= 6 E= -40.1974877724357  delta_E= -8.8e-09  |g|= 1.33e-05  |ddm|= 0.000326
  HOMO = -0.547630927020012  LUMO = 0.195418459331
cycle= 7 E= -40.197487772528  delta_E= -9.23e-11  |g|= 7.46e-07  |ddm|= 3.12e-05
  HOMO = -0.547630838827843  LUMO = 0.195418524351927
Extra cycle  E= -40.1974877725279  delta_E= 5.68e-14  |g|= 1.74e-07  |ddm|= 1.49e-06
converged SCF energy = -40.1974877725279


******** <class 'pyscf.grad.rhf.Gradients'> for <class 'pyscf.scf.hf.RHF'> ********
unit = Eh/Bohr
max_memory 4000 MB (current use 133 MB)
--------------- RHF gradients ---------------
         x                y                z
0 C     0.0000000000     0.0000000000     0.0000000000
1 H    -0.0091685895    -0.0091685895    -0.0091685895
2 H     0.0091685895     0.0091685895    -0.0091685895
3 H     0.0091685895    -0.0091685895     0.0091685895
4 H    -0.0091685895     0.0091685895     0.0091685895
----------------------------------------------
 Recovered energy= -40.1974877725     dipole=      0.000000000000      0.000000000000      0.000000000000
 NRF= 0 NRA=   0 NVA=   5 HaveQM=F NVQ=       0
 Convergence limit is  0.750E-04 MaxStp= 10000 StMxLn= 3.00D-04 StpMin= 1.00D-06.
 Convergence criteria             0.00011250 0.00007500 0.00045000 0.00030000
  Step  NS  ND Rises OKQ   Scale  Max. Force  RMS Force Max. Disp.  RMS Disp.     Energy   Flag
     1   0   0   F    T  1.00D+00 0.00916859 0.00820064 0.00916859 0.00820064  -40.1974878 ----
#INFO: **** input file is /projects/basi7344/software/alpine/research/external_gau/final_script/utils.py ****
from pyscf import gto, scf
import sys
import os
import numpy as np
import fortranformat as ff

basis = 'ccpvdz'
ifile = sys.argv[2]
ofile = sys.argv[3]

def read_gauss_input(ifile):
    with open(ifile, "r") as ifile:
        gau_input = ifile.readlines()

    tokens = gau_input[0].split()

    natoms = int(tokens[0])
    chrg = int(tokens[2])
    spin = int(tokens[3]) -1 
    coords = np.empty((natoms, 4))
    atomtypes=[]
    for i, line in enumerate(gau_input[1 : 1 + natoms]):
        line = line.split()
        line_re = line[:-1]
        coords[i] = line_re
    return natoms, chrg, spin, coords

def convert_to_xyz(data):
    coord_empty = ''
    coord_final =''
    for i, value in enumerate(data):
        coord_empty = ' '.join(f'{x:.8f}' if not float(x).is_integer() else f'{int(x)}' for x in value) 
        coord_final += coord_empty
        if i < len(data)-1:
            coord_final += ';'
    return coord_final

def pyscf_inp():
    mol=gto.Mole()
    mol.spin = s
    mol.charge = c
    mol.basis = basis
    mol.atom = cr
    mol.unit = 'bohr'
    mol.verbose = 4
    mol.build()
    mf = scf.RHF(mol)
    scf_ener = mf.scf()
    nuc_ener = mf.energy_nuc()
    g = mf.nuc_grad_method()
    grad = g.kernel()
    return grad, scf_ener, nuc_ener


def read_gauss_out(ofile, energy, natoms, gradient):

    headformat = ff.FortranRecordWriter("4D20.12")
    bodyformat = ff.FortranRecordWriter("3D20.12")

    f = open(ofile, "w")
    head = [energy, 0 , 0, 0]
    headstring = headformat.write(head)
    f.write(headstring + "\n")

    for i in range(natoms):
        output = bodyformat.write(gradient[i])
        f.write(output + "\n")

    # polarizability and dipole derivatives are set to zero
    polarizability = np.zeros((2, 3))
    dipole_derivative = np.zeros((3 * natoms, 3))

    for i in range(2):
        output = bodyformat.write(polarizability[i])
        f.write(output + "\n")

    for i in range(3 * natoms):
        output = bodyformat.write(dipole_derivative[i])
        f.write(output + "\n")

    f.close()


if __name__=="__main__":
    n , c, s, coord = read_gauss_input(ifile)
    cr = convert_to_xyz(coord)
    gradient, energy_scf, energy_nuc = pyscf_inp()
    read_gauss_out(ofile, energy_scf, n, gradient)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='c3cpu-a2-u32-1.rc.int.colorado.edu', release='4.18.0-305.34.2.el8_4.x86_64', version='#1 SMP Mon Jan 17 09:42:23 EST 2022', machine='x86_64')  Threads 1
Python 3.9.13 (main, Aug 25 2022, 23:26:10) 
[GCC 11.2.0]
numpy 1.21.5  scipy 1.9.1
Date: Tue Sep 10 13:08:05 2024
PySCF version 2.5.0
PySCF path  /projects/basi7344/software/alpine/pyscf
GIT HEAD (branch master) 6d3b24bb64e2a5edb7990b6e3304068981a33f54

[ENV] PYSCF_TMPDIR /scratch/alpine/basi7344/TEMP
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 5
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.622616571103   0.622616571103   0.622616571103 AA    1.176574800000   1.176574800000   1.176574800000 Bohr   0.0
[INPUT]  3 H     -0.622616571103  -0.622616571103   0.622616571103 AA   -1.176574800000  -1.176574800000   1.176574800000 Bohr   0.0
[INPUT]  4 H     -0.622616571103   0.622616571103  -0.622616571103 AA   -1.176574800000   1.176574800000  -1.176574800000 Bohr   0.0
[INPUT]  5 H      0.622616571103  -0.622616571103  -0.622616571103 AA    1.176574800000  -1.176574800000  -1.176574800000 Bohr   0.0

nuclear repulsion = 13.5798648790631
number of shells = 17
number of NR pGTOs = 54
number of NR cGTOs = 34
basis = ccpvdz
ecp = {}
CPU time:         0.41


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/alpine/basi7344/TEMP/tmpvy5s_6oz
max_memory 4000 MB (current use 118 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -40.0649483022944
  HOMO = -0.478314032772551  LUMO = 0.134397383240172
cycle= 1 E= -40.1906934912121  delta_E= -0.126  |g|= 0.148  |ddm|= 1.58
  HOMO = -0.549312249099014  LUMO = 0.189830790584286
cycle= 2 E= -40.1977896460798  delta_E= -0.0071  |g|= 0.0347  |ddm|= 0.114
  HOMO = -0.544217067543591  LUMO = 0.194665794952999
cycle= 3 E= -40.1982784784062  delta_E= -0.000489  |g|= 0.00372  |ddm|= 0.0337
  HOMO = -0.545836575507309  LUMO = 0.194335583869577
cycle= 4 E= -40.1982836942432  delta_E= -5.22e-06  |g|= 0.00109  |ddm|= 0.0049
  HOMO = -0.545457648218763  LUMO = 0.194458223182742
cycle= 5 E= -40.1982841735001  delta_E= -4.79e-07  |g|= 0.000145  |ddm|= 0.00158
  HOMO = -0.54549043623767  LUMO = 0.194440817872698
cycle= 6 E= -40.1982841850593  delta_E= -1.16e-08  |g|= 1.5e-05  |ddm|= 0.00044
  HOMO = -0.545491939481481  LUMO = 0.194438335959111
cycle= 7 E= -40.1982841851662  delta_E= -1.07e-10  |g|= 7.76e-07  |ddm|= 3.3e-05
  HOMO = -0.545491823042895  LUMO = 0.194438412038715
Extra cycle  E= -40.1982841851666  delta_E= -4.12e-13  |g|= 1.84e-07  |ddm|= 1.55e-06
converged SCF energy = -40.1982841851666


******** <class 'pyscf.grad.rhf.Gradients'> for <class 'pyscf.scf.hf.RHF'> ********
unit = Eh/Bohr
max_memory 4000 MB (current use 131 MB)
--------------- RHF gradients ---------------
         x                y                z
0 C     0.0000000000     0.0000000000     0.0000000000
1 H    -0.0053374692    -0.0053374692    -0.0053374692
2 H     0.0053374692     0.0053374692    -0.0053374692
3 H     0.0053374692    -0.0053374692     0.0053374692
4 H    -0.0053374692     0.0053374692     0.0053374692
----------------------------------------------
     2   0   0   F    F  1.47D+00 0.00916859 0.00820064 0.01351839 0.01209121  -40.1982842 ----
#INFO: **** input file is /projects/basi7344/software/alpine/research/external_gau/final_script/utils.py ****
from pyscf import gto, scf
import sys
import os
import numpy as np
import fortranformat as ff

basis = 'ccpvdz'
ifile = sys.argv[2]
ofile = sys.argv[3]

def read_gauss_input(ifile):
    with open(ifile, "r") as ifile:
        gau_input = ifile.readlines()

    tokens = gau_input[0].split()

    natoms = int(tokens[0])
    chrg = int(tokens[2])
    spin = int(tokens[3]) -1 
    coords = np.empty((natoms, 4))
    atomtypes=[]
    for i, line in enumerate(gau_input[1 : 1 + natoms]):
        line = line.split()
        line_re = line[:-1]
        coords[i] = line_re
    return natoms, chrg, spin, coords

def convert_to_xyz(data):
    coord_empty = ''
    coord_final =''
    for i, value in enumerate(data):
        coord_empty = ' '.join(f'{x:.8f}' if not float(x).is_integer() else f'{int(x)}' for x in value) 
        coord_final += coord_empty
        if i < len(data)-1:
            coord_final += ';'
    return coord_final

def pyscf_inp():
    mol=gto.Mole()
    mol.spin = s
    mol.charge = c
    mol.basis = basis
    mol.atom = cr
    mol.unit = 'bohr'
    mol.verbose = 4
    mol.build()
    mf = scf.RHF(mol)
    scf_ener = mf.scf()
    nuc_ener = mf.energy_nuc()
    g = mf.nuc_grad_method()
    grad = g.kernel()
    return grad, scf_ener, nuc_ener


def read_gauss_out(ofile, energy, natoms, gradient):

    headformat = ff.FortranRecordWriter("4D20.12")
    bodyformat = ff.FortranRecordWriter("3D20.12")

    f = open(ofile, "w")
    head = [energy, 0 , 0, 0]
    headstring = headformat.write(head)
    f.write(headstring + "\n")

    for i in range(natoms):
        output = bodyformat.write(gradient[i])
        f.write(output + "\n")

    # polarizability and dipole derivatives are set to zero
    polarizability = np.zeros((2, 3))
    dipole_derivative = np.zeros((3 * natoms, 3))

    for i in range(2):
        output = bodyformat.write(polarizability[i])
        f.write(output + "\n")

    for i in range(3 * natoms):
        output = bodyformat.write(dipole_derivative[i])
        f.write(output + "\n")

    f.close()


if __name__=="__main__":
    n , c, s, coord = read_gauss_input(ifile)
    cr = convert_to_xyz(coord)
    gradient, energy_scf, energy_nuc = pyscf_inp()
    read_gauss_out(ofile, energy_scf, n, gradient)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='c3cpu-a2-u32-1.rc.int.colorado.edu', release='4.18.0-305.34.2.el8_4.x86_64', version='#1 SMP Mon Jan 17 09:42:23 EST 2022', machine='x86_64')  Threads 1
Python 3.9.13 (main, Aug 25 2022, 23:26:10) 
[GCC 11.2.0]
numpy 1.21.5  scipy 1.9.1
Date: Tue Sep 10 13:08:06 2024
PySCF version 2.5.0
PySCF path  /projects/basi7344/software/alpine/pyscf
GIT HEAD (branch master) 6d3b24bb64e2a5edb7990b6e3304068981a33f54

[ENV] PYSCF_TMPDIR /scratch/alpine/basi7344/TEMP
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 5
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.629770195019   0.629770195019   0.629770195019 AA    1.190093190000   1.190093190000   1.190093190000 Bohr   0.0
[INPUT]  3 H     -0.629770195019  -0.629770195019   0.629770195019 AA   -1.190093190000  -1.190093190000   1.190093190000 Bohr   0.0
[INPUT]  4 H     -0.629770195019   0.629770195019  -0.629770195019 AA   -1.190093190000   1.190093190000  -1.190093190000 Bohr   0.0
[INPUT]  5 H      0.629770195019  -0.629770195019  -0.629770195019 AA    1.190093190000  -1.190093190000  -1.190093190000 Bohr   0.0

nuclear repulsion = 13.4256098080106
number of shells = 17
number of NR pGTOs = 54
number of NR cGTOs = 34
basis = ccpvdz
ecp = {}
CPU time:         0.41


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/alpine/basi7344/TEMP/tmpk3zqalln
max_memory 4000 MB (current use 118 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -40.0274801757872
  HOMO = -0.472137060822039  LUMO = 0.132355238396621
cycle= 1 E= -40.1910698726259  delta_E= -0.164  |g|= 0.147  |ddm|= 1.57
  HOMO = -0.547384233740435  LUMO = 0.187785872373109
cycle= 2 E= -40.1982109765108  delta_E= -0.00714  |g|= 0.0352  |ddm|= 0.115
  HOMO = -0.540113861858583  LUMO = 0.193419852303263
cycle= 3 E= -40.1987027849836  delta_E= -0.000492  |g|= 0.00546  |ddm|= 0.0339
  HOMO = -0.542507395303825  LUMO = 0.192851934130496
cycle= 4 E= -40.1987111962565  delta_E= -8.41e-06  |g|= 0.00117  |ddm|= 0.00475
  HOMO = -0.542337983222052  LUMO = 0.192942845914057
cycle= 5 E= -40.19871196652  delta_E= -7.7e-07  |g|= 0.000136  |ddm|= 0.00227
  HOMO = -0.542363370240485  LUMO = 0.192928069505098
cycle= 6 E= -40.1987119774812  delta_E= -1.1e-08  |g|= 1.61e-05  |ddm|= 0.00043
  HOMO = -0.54236527697746  LUMO = 0.192925372794765
cycle= 7 E= -40.1987119776027  delta_E= -1.22e-10  |g|= 8.15e-07  |ddm|= 3.54e-05
  HOMO = -0.542365142822409  LUMO = 0.192925458344427
Extra cycle  E= -40.1987119776032  delta_E= -4.41e-13  |g|= 1.96e-07  |ddm|= 1.63e-06
converged SCF energy = -40.1987119776032


******** <class 'pyscf.grad.rhf.Gradients'> for <class 'pyscf.scf.hf.RHF'> ********
unit = Eh/Bohr
max_memory 4000 MB (current use 131 MB)
--------------- RHF gradients ---------------
         x                y                z
0 C    -0.0000000000    -0.0000000000     0.0000000000
1 H     0.0000036157     0.0000036157     0.0000036157
2 H    -0.0000036157    -0.0000036157     0.0000036157
3 H    -0.0000036157     0.0000036157    -0.0000036157
4 H     0.0000036157    -0.0000036157    -0.0000036157
----------------------------------------------
 MMCGO1:  length 2.44D-17 force  9.84D-07 so reinitializing CG.
     3   0   0   F    T  2.22D+01 0.00000362 0.00000323 0.00008029 0.00007181  -40.1987120 ====
 Running external command " python utils.py R"
         input file       "/scratch/local/7972752/Gau-1467024.EIn"
         output file      "/scratch/local/7972752/Gau-1467024.EOu"
         message file     "/scratch/local/7972752/Gau-1467024.EMs"
         fchk file        "/scratch/local/7972752/Gau-1467024.EFC"
         mat. el file     "/scratch/local/7972752/Gau-1467024.EUF"
#INFO: **** input file is /projects/basi7344/software/alpine/research/external_gau/final_script/utils.py ****
from pyscf import gto, scf
import sys
import os
import numpy as np
import fortranformat as ff

basis = 'ccpvdz'
ifile = sys.argv[2]
ofile = sys.argv[3]

def read_gauss_input(ifile):
    with open(ifile, "r") as ifile:
        gau_input = ifile.readlines()

    tokens = gau_input[0].split()

    natoms = int(tokens[0])
    chrg = int(tokens[2])
    spin = int(tokens[3]) -1 
    coords = np.empty((natoms, 4))
    atomtypes=[]
    for i, line in enumerate(gau_input[1 : 1 + natoms]):
        line = line.split()
        line_re = line[:-1]
        coords[i] = line_re
    return natoms, chrg, spin, coords

def convert_to_xyz(data):
    coord_empty = ''
    coord_final =''
    for i, value in enumerate(data):
        coord_empty = ' '.join(f'{x:.8f}' if not float(x).is_integer() else f'{int(x)}' for x in value) 
        coord_final += coord_empty
        if i < len(data)-1:
            coord_final += ';'
    return coord_final

def pyscf_inp():
    mol=gto.Mole()
    mol.spin = s
    mol.charge = c
    mol.basis = basis
    mol.atom = cr
    mol.unit = 'bohr'
    mol.verbose = 4
    mol.build()
    mf = scf.RHF(mol)
    scf_ener = mf.scf()
    nuc_ener = mf.energy_nuc()
    g = mf.nuc_grad_method()
    grad = g.kernel()
    return grad, scf_ener, nuc_ener


def read_gauss_out(ofile, energy, natoms, gradient):

    headformat = ff.FortranRecordWriter("4D20.12")
    bodyformat = ff.FortranRecordWriter("3D20.12")

    f = open(ofile, "w")
    head = [energy, 0 , 0, 0]
    headstring = headformat.write(head)
    f.write(headstring + "\n")

    for i in range(natoms):
        output = bodyformat.write(gradient[i])
        f.write(output + "\n")

    # polarizability and dipole derivatives are set to zero
    polarizability = np.zeros((2, 3))
    dipole_derivative = np.zeros((3 * natoms, 3))

    for i in range(2):
        output = bodyformat.write(polarizability[i])
        f.write(output + "\n")

    for i in range(3 * natoms):
        output = bodyformat.write(dipole_derivative[i])
        f.write(output + "\n")

    f.close()


if __name__=="__main__":
    n , c, s, coord = read_gauss_input(ifile)
    cr = convert_to_xyz(coord)
    gradient, energy_scf, energy_nuc = pyscf_inp()
    read_gauss_out(ofile, energy_scf, n, gradient)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='c3cpu-a2-u32-1.rc.int.colorado.edu', release='4.18.0-305.34.2.el8_4.x86_64', version='#1 SMP Mon Jan 17 09:42:23 EST 2022', machine='x86_64')  Threads 1
Python 3.9.13 (main, Aug 25 2022, 23:26:10) 
[GCC 11.2.0]
numpy 1.21.5  scipy 1.9.1
Date: Tue Sep 10 13:08:08 2024
PySCF version 2.5.0
PySCF path  /projects/basi7344/software/alpine/pyscf
GIT HEAD (branch master) 6d3b24bb64e2a5edb7990b6e3304068981a33f54

[ENV] PYSCF_TMPDIR /scratch/alpine/basi7344/TEMP
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 5
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = bohr
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.629770195019   0.629770195019   0.629770195019 AA    1.190093190000   1.190093190000   1.190093190000 Bohr   0.0
[INPUT]  3 H     -0.629770195019  -0.629770195019   0.629770195019 AA   -1.190093190000  -1.190093190000   1.190093190000 Bohr   0.0
[INPUT]  4 H     -0.629770195019   0.629770195019  -0.629770195019 AA   -1.190093190000   1.190093190000  -1.190093190000 Bohr   0.0
[INPUT]  5 H      0.629770195019  -0.629770195019  -0.629770195019 AA    1.190093190000  -1.190093190000  -1.190093190000 Bohr   0.0

nuclear repulsion = 13.4256098080106
number of shells = 17
number of NR pGTOs = 54
number of NR cGTOs = 34
basis = ccpvdz
ecp = {}
CPU time:         0.40


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/alpine/basi7344/TEMP/tmpcy57jjw2
max_memory 4000 MB (current use 118 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -40.0274801757872
  HOMO = -0.472137060822039  LUMO = 0.132355238396621
cycle= 1 E= -40.1910698726259  delta_E= -0.164  |g|= 0.147  |ddm|= 1.57
  HOMO = -0.547384233740435  LUMO = 0.187785872373109
cycle= 2 E= -40.1982109765108  delta_E= -0.00714  |g|= 0.0352  |ddm|= 0.115
  HOMO = -0.540113861858583  LUMO = 0.193419852303263
cycle= 3 E= -40.1987027849836  delta_E= -0.000492  |g|= 0.00546  |ddm|= 0.0339
  HOMO = -0.542507395303825  LUMO = 0.192851934130496
cycle= 4 E= -40.1987111962565  delta_E= -8.41e-06  |g|= 0.00117  |ddm|= 0.00475
  HOMO = -0.542337983222052  LUMO = 0.192942845914057
cycle= 5 E= -40.19871196652  delta_E= -7.7e-07  |g|= 0.000136  |ddm|= 0.00227
  HOMO = -0.542363370240485  LUMO = 0.192928069505098
cycle= 6 E= -40.1987119774812  delta_E= -1.1e-08  |g|= 1.61e-05  |ddm|= 0.00043
  HOMO = -0.54236527697746  LUMO = 0.192925372794765
cycle= 7 E= -40.1987119776027  delta_E= -1.22e-10  |g|= 8.15e-07  |ddm|= 3.54e-05
  HOMO = -0.542365142822409  LUMO = 0.192925458344427
Extra cycle  E= -40.1987119776032  delta_E= -4.41e-13  |g|= 1.96e-07  |ddm|= 1.63e-06
converged SCF energy = -40.1987119776032


******** <class 'pyscf.grad.rhf.Gradients'> for <class 'pyscf.scf.hf.RHF'> ********
unit = Eh/Bohr
max_memory 4000 MB (current use 131 MB)
--------------- RHF gradients ---------------
         x                y                z
0 C    -0.0000000000    -0.0000000000     0.0000000000
1 H     0.0000036157     0.0000036157     0.0000036157
2 H    -0.0000036157    -0.0000036157     0.0000036157
3 H    -0.0000036157     0.0000036157    -0.0000036157
4 H     0.0000036157    -0.0000036157    -0.0000036157
----------------------------------------------
 Recovered energy= -40.1987119776     dipole=      0.000000000000      0.000000000000      0.000000000000
 Energy=    -40.1987120     NIter=   0.
 Dipole moment=       0.000000       0.000000       0.000000
 ***** Axes restored to original set *****
 -------------------------------------------------------------------
 Center     Atomic                   Forces (Hartrees/Bohr)
 Number     Number              X              Y              Z
 -------------------------------------------------------------------
      1        6           0.000000000   -0.000000000   -0.000000000
      2        1          -0.000002087    0.000005904    0.000000000
      3        1          -0.000002088   -0.000002952   -0.000005113
      4        1          -0.000002088   -0.000002952    0.000005113
      5        1           0.000006263   -0.000000000   -0.000000000
 -------------------------------------------------------------------
 Cartesian Forces:  Max     0.000006263 RMS     0.000003234

 GradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGrad
 Berny optimization.
 Search for a local minimum.
 Step number   1 out of a maximum of    2
 All quantities printed in internal units (Hartrees-Bohrs-Radians)
 Mixed Optimization -- En-DIIS/RFO-DIIS
 Second derivative matrix not updated -- unit matrix used.
 ITU=  0
 RFO step:  Lambda= 0.00000000D+00 EMin= 1.00000000D+00
 ClnCor:  largest displacement from symmetrization is 5.66D-15 for atom     4.
 Linear search not attempted -- first point.
 ClnCor:  largest displacement from symmetrization is 1.88D-15 for atom     4.
 Variable       Old X    -DE/DX   Delta X   Delta X   Delta X     New X
                                 (Linear)    (Quad)   (Total)
    X1       -1.52845   0.00000   0.00000   0.00000   0.00000  -1.52845
    Y1        0.55580  -0.00000   0.00000   0.00000  -0.00000   0.55580
    Z1        0.00000  -0.00000   0.00000  -0.00000  -0.00000   0.00000
    X2       -0.84138  -0.00000   0.00000  -0.00000  -0.00000  -0.84138
    Y2       -1.38762   0.00001   0.00000   0.00001   0.00001  -1.38761
    Z2       -0.00000   0.00000   0.00000   0.00000   0.00000  -0.00000
    X3       -0.84134  -0.00000   0.00000  -0.00000  -0.00000  -0.84134
    Y3        1.52750  -0.00000   0.00000  -0.00000  -0.00000   1.52750
    Z3        1.68305  -0.00001   0.00000  -0.00001  -0.00001   1.68304
    X4       -0.84134  -0.00000   0.00000  -0.00000  -0.00000  -0.84135
    Y4        1.52750  -0.00000   0.00000  -0.00000  -0.00000   1.52750
    Z4       -1.68305   0.00001   0.00000   0.00001   0.00001  -1.68304
    X5       -3.58976   0.00001   0.00000   0.00001   0.00001  -3.58975
    Y5        0.55583  -0.00000   0.00000  -0.00000  -0.00000   0.55583
    Z5        0.00000  -0.00000   0.00000  -0.00000  -0.00000   0.00000
         Item               Value     Threshold  Converged?
 Maximum Force            0.000006     0.000450     YES
 RMS     Force            0.000003     0.000300     YES
 Maximum Displacement     0.000006     0.001800     YES
 RMS     Displacement     0.000003     0.001200     YES
 Predicted change in Energy=-7.844112D-11
 Optimization completed.
    -- Stationary point found.
 GradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGradGrad

                          Input orientation:                          
 ---------------------------------------------------------------------
 Center     Atomic      Atomic             Coordinates (Angstroms)
 Number     Number       Type             X           Y           Z
 ---------------------------------------------------------------------
      1          6           0       -0.808824    0.294118    0.000000
      2          1           0       -0.445238   -0.734297   -0.000001
      3          1           0       -0.445219    0.808318    0.890630
      4          1           0       -0.445220    0.808319   -0.890630
      5          1           0       -1.899618    0.294131    0.000001
 ---------------------------------------------------------------------
                    Distance matrix (angstroms):
                    1          2          3          4          5
     1  C    0.000000
     2  H    1.090794   0.000000
     3  H    1.090794   1.781259   0.000000
     4  H    1.090794   1.781259   1.781259   0.000000
     5  H    1.090794   1.781259   1.781259   1.781259   0.000000
 Stoichiometry    CH4
 Framework group  TD[O(C),4C3(H)]
 Deg. of freedom     1
 Full point group                 TD      NOp  24
 Omega: Change in point group or standard orientation.

 Old FWG=T    [O(C1),4C3(H1)]
 New FWG=TD   [O(C1),4C3(H1)]
 Largest Abelian subgroup         D2      NOp   4
 Largest concise Abelian subgroup D2      NOp   4
                         Standard orientation:                         
 ---------------------------------------------------------------------
 Center     Atomic      Atomic             Coordinates (Angstroms)
 Number     Number       Type             X           Y           Z
 ---------------------------------------------------------------------
      1          6           0        0.000000    0.000000    0.000000
      2          1           0        0.629770    0.629770    0.629770
      3          1           0       -0.629770   -0.629770    0.629770
      4          1           0       -0.629770    0.629770   -0.629770
      5          1           0        0.629770   -0.629770   -0.629770
 ---------------------------------------------------------------------
 Rotational constants (GHZ):         158.0439468         158.0439468         158.0439468
 Unable to Open any file for archive entry.
 1\1\GINC-C3CPU-A2-U32-1\FOpt\External=' python utils.py'\ZDO\C1H4\BASI
 7344\10-Sep-2024\0\\# opt external=" python utils.py"\\test external\\
 0,1\C,-0.808823549,0.294117597,0.\H,-0.4452380225,-0.7342972277,-0.000
 0008759\H,-0.4452186117,0.8083178937,0.8906295476\H,-0.4452200421,0.80
 83189052,-0.8906295476\H,-1.8996175197,0.2941308168,0.0000008759\\Vers
 ion=ES64L-G16RevC.02\HF=-40.198712\RMSD=0.000e+00\RMSF=3.234e-06\Dipol
 e=0.,0.,0.\PG=TD [O(C1),4C3(H1)]\\@
 The archive entry for this job was punched.


 THERE ARE PEOPLE SO ADDICTED TO EXAGERATING THEY
 CAN'T TELL THE TRUTH WITHOUT LYING. -- FORTUNE COOKIE
 Job cpu time:       0 days  0 hours  0 minutes  0.3 seconds.
 Elapsed time:       0 days  0 hours  0 minutes 22.0 seconds.
 File lengths (MBytes):  RWF=      6 Int=      0 D2E=      0 Chk=      1 Scr=      1
 Normal termination of Gaussian 16 at Tue Sep 10 13:08:08 2024.
